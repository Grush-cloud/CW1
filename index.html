<html>
    <head>
        <title>Lessons</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
        <script src="https://unpkg.com/vue"></script>
        <script src="lessons.js"></script>
    </head>
    <body>


        <div id="app">
            <header>
                <h1 v-text="sitename"></h1>
                <button v-on:click='showCheckout'>
                    {{cartItemCount}}
                    <span class="fas fa-cart-plus"></span> Show Checkout
                </button>
            </header>
            <div>
                <p>Sort by</p>
                <fieldset>
                    <label>
                        <input v-model="sort" type="radio" name="Sort" value="price" v-on:click="sortedLessons('price', ord)"> Price
                    </label><br>
                    <label>
                        <input v-model="sort" type="radio" name="Sort" value="subj"> Subject
                    </label><br>
                    <label>
                        <input v-model="sort" type="radio" name="Sort" value="loc"> Location
                    </label><br>
                    <label>
                        <input v-model="sort" type="radio" name="Sort" value="avail"> Availability
                    </label><br>
                </fieldset>

                <p>Order</p>
                <fieldset>
                    <label>
                        <input v-model="ord" type="radio" name="Order" value="asc"> Ascending
                    </label><br>
                    <label>
                        <input type="radio" name="Order" value="des" v-model="ord"> Descending
                    </label><br>
                </fieldset>
                     
                </div>
            <main>
               
                    
                
               
                    
                <div v-if='showProduct'>
                    <div v-for="lesson in sortedLessons(sort, ord)">
                        <h2 v-text="lesson.title">Lessons</h2>
                
                    <figure>
                    
                    <img v-bind:src="lesson.image">
                </figure>
                
                <p v-html="lesson.description"></p>

     
               <p>Subject: {{lesson.subject}}</p>
                <p>Price: {{lesson.price}}</p>
                <p>Location:{{lesson.location}}</p>
                <p>Number of spaces: {{lesson.spaces}}</p>
                

                <button v-on:click='addToCart(lesson)' v-if='canAddToCart(lesson)'>Add to cart</button>

                

                <button disabled="disabled" v-else>Add to cart</button>

                
                </div>

            </div>

                <div v-else>
                    <h2>Checkout</h2>
                    <p>
                        <strong>Name:</strong>
                        <input v-model="order.Name">
                    </p>

                    <p>
                        <strong>Phone:</strong>
                        <input v-model="order.Phone">

                    </p>

                   

                  

                    

                    <button v-on:click="submitForm">Place Order</button>
            </main>
        </div>

        




        <script type="text/javascript">
        var webstore = new Vue({
            el: '#app', 
            data: {
            sitename: 'Lessons Online Store',
            showProduct:true,
             lessons: lessons,
             
            cart: [],
            showProduct:true,

            order:{
                Name: '',
                Phone: '',
                default: 'subject',
                ascdes:'ascend',
            },
            sort: "subj",
            ord: "asc",

         },
    


         methods:{
            sortedLessons(sort, order) {
                            let lessonsArray = this.lessons.slice(0);
                            switch (sort) {
                                // sort by price
                                case "price":
                                    if (order == "asc") {
                                        function comparePrice(a, b) {
                                            if (a.price > b.price)
                                                return 1
                                            if (a.price < b.price)
                                                return -1
                                            return 0
                                        }
                                        return lessonsArray.sort(comparePrice)
                                    } else {
                                        function comparePrice(a, b) {
                                            if (a.price > b.price)
                                                return -1
                                            if (a.price < b.price)
                                                return 1
                                            return 0
                                        }
                                        return lessonsArray.sort(comparePrice)
                                    }
                                    break;
                                
                                // sort by location
                                case "loc":
                                    if (order == "asc") {
                                        function compareLocation(a, b) {
                                            if (a.location > b.location)
                                                return 1
                                            if (a.location < b.location)
                                                return -1
                                            return 0
                                        }
                                        return lessonsArray.sort(compareLocation)
                                    } else {
                                        function compareLocation(a, b) {
                                            if (a.location > b.location)
                                                return -1
                                            if (a.location < b.location)
                                                return 1
                                            return 0
                                        }
                                        return lessonsArray.sort(compareLocation)
                                    }
                                    break;
                                
                                // sort by availability
                                case "avail":
                                    if (order == "asc") {
                                        function compareAvailability(a, b) {
                                            if (a.spaces > b.spaces)
                                                return 1
                                            if (a.spaces < b.spaces)
                                                return -1
                                            return 0
                                        }
                                        return lessonsArray.sort(compareAvailability)
                                    } else {
                                        function compareAvailability(a, b) {
                                            if (a.spaces > b.spaces)
                                                return -1
                                            if (a.spaces < b.spaces)
                                                return 1
                                            return 0
                                        }
                                        return lessonsArray.sort(compareAvailability)
                                    }
                                    break;

                                // by default, compare subject
                                default:
                                    if (order == "asc") {
                                        function compareSubject(a, b) {
                                            if (a.subject > b.subject)
                                                return 1
                                            if (a.subject < b.subject)
                                                return -1
                                            return 0
                                        }
                                        return lessonsArray.sort(compareSubject)
                                    } else {
                                        function compareSubject(a, b) {
                                            if (a.subject > b.subject)
                                                return -1
                                            if (a.subject < b.subject)
                                                return 1
                                            return 0
                                        }
                                        return lessonsArray.sort(compareSubject)
                                    }
                                    break;
                            }
                        },

                        addToCart: function (lesson) {
                            this.cart.push(lesson);
                        },
                        removeFromCart: function (lesson){
                            this.cart.splice(this.cart.indexOf(lesson))
                        },
                        cartCount(id) {
                            let count = 0;
                            for (let i = 0; i < this.cart.length; i++) {
                                if (this.cart[i] === id) {
                                    count++;
                                }
                            }
                            return count;
                        },
                        canAddToCart: function (lesson) {
                            return lesson.spaces > this.cartCount(lesson);
                        },
                        showCheckout() {
                            this.shop = this.shop ? false : true;
                        },
        

         },
         

         computed:{
     
        cartItemCount:function(){
            return this.cart.length || '';

        }



         },
     
         });

     
    </script>
</body>
</html>